{% extends "shop/base_shop.html" %}
{% load static %}

{% block title %}Cozy Shop{% endblock %}
{% block nav_shop_active %}active{% endblock %}

{% block shop_content %}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="text-light mb-0">
        <i class="fa-solid fa-cart-shopping me-2 text-warning"></i>
        Cozy Shop
    </h2>
</div>

{% if not ordering_enabled %}
<div class="alert alert-warning text-dark fw-bold mb-4">
    <i class="fa-solid fa-box-open me-2"></i>
    Ordering is currently suspended due to supply issues.
</div>
{% endif %}

<div class="row g-4">
    {% for p in products %}
    <div class="col-md-4">
        <div class="card bg-dark text-light h-100 shadow">

            {% if p.image %}
            <img src="{{ p.image.url }}" class="card-img-top" alt="{{ p.title }}">
            {% else %}
            <img src="{% static 'img/no-image.png' %}" class="card-img-top" alt="No image">
            {% endif %}

            <div class="card-body d-flex flex-column">
                <h4 class="card-title">{{ p.title }}</h4>

                <p class="text-muted small">{{ p.description|truncatewords:18 }}</p>

                <p class="fw-bold text-warning">Â£{{ p.price }}</p>

                <a href="{% url 'shop_product_detail' p.id %}" class="btn btn-outline-warning mt-auto">
                    View Product
                </a>
                <form action="{% url 'basket_add' p.id %}" method="POST" class="mt-2">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-warning w-100">
                        <i class="fa-solid fa-cart-plus me-1"></i> Add to Basket
                    </button>
                </form>


                {% if p.is_staff_only %}
                <span class="badge bg-danger mt-2">Staff Only</span>
                {% endif %}
            </div>
        </div>
    </div>
    {% empty %}
    <p class="text-light">No products available.</p>
    {% endfor %}
</div>

{% endblock %}