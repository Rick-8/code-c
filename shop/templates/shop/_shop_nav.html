{% load static %}

<style>
    /* NAVBAR ABOVE EVERYTHING */
    .cozy-shop-navbar {
        position: relative;
    }

    /* Remove Bootstrap's backdrop completely */
    .offcanvas-backdrop,
    .offcanvas-backdrop.show {
        display: none !important;
        opacity: 0 !important;
    }

    /* Fix offcanvas so it always stays above nav + content */
    #shopManagerPanel {
        width: 300px !important;
        backdrop-filter: blur(12px);
        background: rgba(15, 15, 15, 0.90) !important;

        position: fixed !important;
        top: 0;
        right: 0;
        height: 100%;

        pointer-events: auto !important;
    }

    #shopManagerPanel .offcanvas-body {
        padding-top: 0.5rem;
    }
</style>



<!-- ========================= -->
<!--        SHOP NAVBAR        -->
<!-- ========================= -->
<div class="cozy-dark-glass p-2 shadow-lg cozy-shop-navbar"
     style="border-radius:0;width:100%;margin:0;">

    <div class="container d-flex flex-wrap justify-content-between align-items-center">

        <!-- Search -->
        <form method="GET"
              action="{% url 'shop_home' %}"
              class="d-flex mb-2 mb-md-0"
              style="flex:1;max-width:360px;">

            <input type="text"
                   name="q"
                   value="{{ request.GET.q }}"
                   class="form-control form-control-sm bg-dark text-light border-secondary"
                   placeholder="Search products...">

            <button class="btn btn-warning btn-sm ms-2">
                <i class="fa-solid fa-search"></i>
            </button>
        </form>

        <!-- Icons -->
        <div class="d-flex align-items-center gap-3">

            <a href="{% url 'shop_basket' %}" class="text-light position-relative">
                <i class="fa-solid fa-basket-shopping fs-5"></i>
                {% if cart_count and cart_count > 0 %}
                <span class="badge bg-warning text-dark position-absolute top-0 start-100 translate-middle"
                      style="font-size:0.65rem;">
                    {{ cart_count }}
                </span>
                {% endif %}
            </a>

            <a href="{% url 'shop_orders' %}" class="text-light">
                <i class="fa-solid fa-box fs-5"></i>
            </a>

            {% if request.user.is_superuser %}
            <a class="text-warning"
               data-bs-toggle="offcanvas"
               href="#shopManagerPanel"
               title="Shop Manager">
                <i class="fa-solid fa-user-gear fs-4"></i>
            </a>
            {% endif %}

        </div>
    </div>
</div>



{% if request.user.is_superuser %}
<!-- ========================================== -->
<!--  OFFCANVAS ADMIN PANEL — FIXED RIGHT PANEL -->
<!-- ========================================== -->

</style>


<div class="offcanvas offcanvas-end"
     tabindex="-1"
     id="shopManagerPanel"
     aria-labelledby="shopManagerPanelLabel"
     data-bs-backdrop="false">

    <div class="offcanvas-header py-2">
        <h5 class="offcanvas-title text-warning" id="shopManagerPanelLabel">
            <i class="fa-solid fa-toolbox me-2"></i> Manager
        </h5>
        <button type="button" class="btn-close btn-close-white"
                data-bs-dismiss="offcanvas"></button>
    </div>

    <div class="offcanvas-body">

        <!-- SHOP STATUS -->
        <div class="mb-3 p-2 bg-dark rounded-3">
            <h6 class="text-warning mb-2">
                <i class="fa-solid fa-power-off me-1"></i> Shop Status
            </h6>

            {% if ordering_enabled %}
                <p class="small mb-2">
                    Ordering is: <span class="text-success fw-bold">ENABLED</span>
                </p>
                <a href="{% url 'shop_disable' %}"
                   class="btn btn-sm btn-danger w-100">Disable</a>
            {% else %}
                <p class="small mb-2">
                    Ordering is: <span class="text-danger fw-bold">DISABLED</span>
                </p>
                <a href="{% url 'shop_enable' %}"
                   class="btn btn-sm btn-success w-100">Enable</a>
            {% endif %}
        </div>

        <!-- QUICK LINKS -->
        <div class="mb-3">
            <h6 class="text-warning mb-2">
                <i class="fa-solid fa-list-check me-1"></i> Quick Actions
            </h6>

            <a href="{% url 'shop_manage_products' %}"
               class="btn btn-outline-warning btn-sm w-100 mb-2">Manage Products</a>

            <a href="{% url 'shop_add_product' %}"
               class="btn btn-outline-warning btn-sm w-100 mb-2">Add Product</a>

            <a href="{% url 'shop_orders' %}"
               class="btn btn-outline-warning btn-sm w-100 mb-2">Orders</a>
        </div>

        <div class="mt-3 pt-2 border-top border-secondary">
            <p class="small text-light mb-0">More tools coming soon…</p>
        </div>

    </div>
</div>
{% endif %}


